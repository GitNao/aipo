#*
 * Aipo is a groupware program developed by Aimluck,Inc.
 * Copyright (C) 2004-2011 Aimluck,Inc.
 * http://www.aipo.com
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *#
## ---------------------------------------------------------------------------
## ---------------------------------------------------------------------------
#set ($newUrl = $!utils.escapeXML($!jslink.getPortletById($!portlet.ID).addQueryData("template","WikiFormScreen").addQueryData("entityid","new").addQueryData("wikipage","parent")))##.addQueryData("page","parent")
#set ($indicator_id = "indicator-list-")
## ---------------------------------------------------------------------------
#set ($categoryEtc = false)
## ---------------------------------------------------------------------------
#AUIcontentsAreaHeader()
<h2>$l10n.WIKI_MANAGEMENT</h2>
<div class="auiSummaryMeta auiFilter clearfix">
<form class="auiSearch" style="margin-right:1em;" id="searchForm_$!{portlet.ID}" action="$!jslink.getPortletById($!portlet.ID)" onsubmit='aimluck.io.postViewPage(this, "$!{portlet.ID}", "search-${indicator_id}"); return false;'>
<div class="filterInputField">
<input type="hidden" name="baseuri_$!{portlet.ID}" id="baseuri_$!{portlet.ID}" value='$!jslink.getPortletById($!portlet.ID).addQueryData("template","WikiListScreen")' />
<input type="hidden" name="template" value="WikiListScreen"/>

<div class="filters" id="filters_$!portlet.ID">
#if("$!result.PostName"!="")
<span class="filterTip">
<span>$!result.PostName</span>
<a href="javascript:void(0);" class="btn" onclick="aipo.wiki.filterSetDefault('$!portlet.ID','post');"><i class="auiIcon auiIconDelete"></i></a>
</span>
#end
#if("$!result.CategoryName"!="")
<span class="filterTip">
<span>$!result.CategoryName</span>
<a href="javascript:void(0);" class="btn" onclick='aipo.wiki.filterSetDefault("$!portlet.ID","category");'><i class="auiIcon auiIconDelete"></i></a>
</span>
#end
</div>

<a href="javascript:void(0);" id="filter_drawer_$!portlet.ID" class="filterDropDrawer menubarOpenButton" onclick='aipo.wiki.toggleMenu(dojo.byId("menubar_auiFilter_$!portlet.ID"),dojo.byId("filters_$!portlet.ID"),true);' title="フィルタ"><i class="auiIcon auiIconArwBottom"></i></a>
<input class="text floatLeft long" style="margin-right:5px;" type="text" name="keyword" id="q$!{portlet.ID}" value="$!result.targetKeyword" onfocus='aipo.wiki.initFilterSearch("$!portlet.ID");' onblur='aipo.wiki.finFilterSearch("$!portlet.ID");' />
</div>
<a href="javascript:void(0);" class="auiButtonSearch floatLeft" onclick="dojo.byId('searchForm_$!{portlet.ID}').onsubmit(); return false;">$l10n.WIKI_SEARCH</a>
<div class="indicatorWrap floatLeft ml10" style="padding-top: 0.4em;">#ALajaxIndicator("search-${indicator_id}" "$!{portlet.ID}" "&nbsp;")</div>
</form>
</div>
#ALajaxlistformheaderAction('Wiki')
#if($result.List.size() <= 0)
#AUIbuttonActionInBlankBox($l10n.WIKI_CATEGORY_ADD "javascript:aipo.common.showDialog('$newUrl','$!portlet.ID',aipo.wiki.aipo.wiki.onLoadWikiDialog);")
#else
#AUISummaryFilterDivHeader()
	#AUISearchHeaderMarginOne()
		<div class="filterInputField">
			<div class="filters"><!--span class="filterTip"><span>Wiki名Wiki名</span><a href="javascript:void()" onclick="this.parentNode.style.display='none'"><i class="auiIcon auiIconDelete"></i></a></span--></div>
			<a href="javascript:void(0);" onclick="if(document.getElementById('menubar_auiFilter_1').style.display!='none'){document.getElementById('menubar_auiFilter_1').style.display='none'}else{document.getElementById('menubar_auiFilter_1').style.display='block'}" title="フィルタ" class="filterDropDrawer"><span><i class="auiIcon auiIconArwBottom"></i></span></a>
			<input class="text" type="text" name="q" id="q" style="width:320px;">
		</div>
		#AUIButtonSearch("aimluck.io.setHiddenValue(this);" $l10n.WIKI_SEARCH)
	#AUISearchFooter()
#AUISummaryFilterDivFooter()


#AUISummaryDiv()
#AUIajaxbuttonCheckboxDelete($l10n.WIKI_DELETE "$!jslink.getPortletById($!portlet.ID).addQueryData('template','WikiFormJSONScreen').addQueryData('mode','multi_delete')" "$indicator_id" "$!portlet.ID" "aipo.wiki.onListReceiveMessage")
#AUIajaxpageview('WikiTopListScreen' $result)
#AUISummaryDivfooter()
<table class="auiRowTable auiMbTable wide">
	<colgroup span="3"></colgroup>
	<colgroup style="width: 9em;"></colgroup>
	<tbody>
		<tr>
			#ALtdheadAtt("#ALswitchCheckbox()" "class='center auiMTCheck'")
			#ALtdheadAtt("#ALajaxsort('wiki_name' $l10n.WIKI_TITLE $result 'WikiListScreen')" "")
			#ALtdheadAtt("#ALajaxsort('update_user' $l10n.WIKI_UPDATE_USER $result 'WikiListScreen')" "class='wName'")
			#ALtdheadAtt("#ALajaxsort('update_date' $l10n.WIKI_UPDATE_DATE $result 'WikiListScreen')" "")
		</tr>
		#foreach ($record in $result.List)
		<tr>
			#ALtdcellheaderAtt('align="center" class="auiMTCheck"')
			<input name="check$!record.Id" type="checkbox" value="$!record.Id" />
		    #ALtdcellfooter()
		    #ALtdcellheaderAtt('class="auiMTCaption"')
				<div>
					<a href="javascript:void(0);" onclick="aipo.common.showDialog('$!utils.escapeXML($!jslink.getPortletById($!portlet.ID).addQueryData("template","WikiDetailScreen").addQueryData("entityid",$record.Id))');" >$!record.NameHtml</a>
				</div>
			#ALtdcellfooter()
			<td><div>$!record.UpdateUser</div></td>
			<td>$!record.UpdateDate</td>
		</tr>
		#end
	</tbody>
</table>
#end
#AUIcontentsAreaFooter()

#parse("/portlets/html/ja/wiki-widgets.vm")
